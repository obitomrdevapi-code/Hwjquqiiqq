const express = require("express");
const router = express.Router();

const questionsBank = {
  cultural: {
    easy: [
      {
        question: "ما هي عاصمة فرنسا؟",
        answer: "باريس",
        options: ["لندن", "باريس", "روما", "برلين"]
      },
      {
        question: "من هو مؤلف رواية 'البؤساء'؟",
        answer: "فيكتور هوغو",
        options: ["فيكتور هوغو", "شارلز ديكنز", "ليو تولستوي", "أونوريه دي بلزاك"]
      },
      {
        question: "ما هي اللغة الرسمية في البرازيل؟",
        answer: "البرتغالية",
        options: ["الإسبانية", "البرتغالية", "الإنجليزية", "الفرنسية"]
      },
      {
        question: "في أي عام انتهت الحرب العالمية الثانية؟",
        answer: "1945",
        options: ["1944", "1945", "1946", "1947"]
      },
      {
        question: "ما هو أطول نهر في العالم؟",
        answer: "نهر النيل",
        options: ["نهر الأمازون", "نهر النيل", "نهر المسيسيبي", "نهر اليانغتسي"]
      }
    ],
    medium: [
      {
        question: "ما هي عاصمة أستراليا؟",
        answer: "كانبرا",
        options: ["سيدني", "ملبورن", "كانبرا", "بريزبان"]
      },
      {
        question: "من هو مؤلف مسرحية 'هاملت'؟",
        answer: "وليام شكسبير",
        options: ["وليام شكسبير", "أوسكار وايلد", "جورج برنارد شو", "صمويل بيكيت"]
      }
    ],
    hard: [
      {
        question: "من هو الفيلسوف الذي قال: 'أنا أفكر إذن أنا موجود'؟",
        answer: "رينيه ديكارت",
        options: ["رينيه ديكارت", "أفلاطون", "أرسطو", "سقراط"]
      },
      {
        question: "ما هي اللغة التي كتبت بها مخطوطات البحر الميت؟",
        answer: "الآرامية",
        options: ["الآرامية", "العبرية", "اليونانية", "اللاتينية"]
      }
    ]
  },

  islamic: {
    easy: [
      {
        question: "كم عدد أركان الإسلام؟",
        answer: "5",
        options: ["5", "6", "4", "7"]
      },
      {
        question: "ما هو أول شهر في التقويم الهجري؟",
        answer: "المحرم",
        options: ["المحرم", "صفر", "ربيع الأول", "رجب"]
      },
      {
        question: "من هو أول نبي؟",
        answer: "آدم",
        options: ["آدم", "نوح", "إبراهيم", "موسى"]
      },
      {
        question: "ما هي آخر سورة في القرآن؟",
        answer: "الناس",
        options: ["الناس", "الفلق", "الإخلاص", "المسد"]
      },
      {
        question: "كم عدد سور القرآن؟",
        answer: "114",
        options: ["114", "113", "115", "112"]
      }
    ],
    medium: [
      {
        question: "ما هي السورة التي تسمى قلب القرآن؟",
        answer: "يس",
        options: ["يس", "الرحمن", "الواقعة", "الملك"]
      },
      {
        question: "من هو الصحابي الملقب بسيف الله المسلول؟",
        answer: "خالد بن الوليد",
        options: ["خالد بن الوليد", "عمرو بن العاص", "سعد بن أبي وقاص", "علي بن أبي طالب"]
      }
    ],
    hard: [
      {
        question: "ما هي السورة التي لم تبدأ بالبسملة؟",
        answer: "التوبة",
        options: ["التوبة", "الأنفال", "المجادلة", "الحديد"]
      },
      {
        question: "من هو الصحابي الذي اهتز لموته عرش الرحمن؟",
        answer: "سعد بن معاذ",
        options: ["سعد بن معاذ", "حمزة بن عبد المطلب", "أبو بكر الصديق", "عمر بن الخطاب"]
      }
    ]
  },

  football: {
    easy: [
      {
        question: "كم عدد لاعبي كرة القدم في كل فريق؟",
        answer: "11",
        options: ["11", "10", "12", "9"]
      },
      {
        question: "ما هي مدة المباراة الرسمية في كرة القدم؟",
        answer: "90 دقيقة",
        options: ["90 دقيقة", "80 دقيقة", "100 دقيقة", "120 دقيقة"]
      },
      {
        question: "من هو أفضل لاعب في العالم 2023؟",
        answer: "ليونيل ميسي",
        options: ["ليونيل ميسي", "كريستيانو رونالدو", "كيليان مبابي", "إرلينغ هالاند"]
      },
      {
        question: "ما هو الفريق الذي فاز بكأس العالم 2022؟",
        answer: "الأرجنتين",
        options: ["الأرجنتين", "فرنسا", "البرازيل", "ألمانيا"]
      },
      {
        question: "ما هي البطولة الأهم في أوروبا للأندية؟",
        answer: "دوري أبطال أوروبا",
        options: ["دوري أبطال أوروبا", "الدوري الأوروبي", "كأس العالم للأندية", "كأس السوبر الأوروبي"]
      }
    ],
    medium: [
      {
        question: "من هو الهداف التاريخي لكرة القدم؟",
        answer: "كريستيانو رونالدو",
        options: ["كريستيانو رونالدو", "ليونيل ميسي", "بيليه", "روماريو"]
      },
      {
        question: "ما هو الفريق الذي فاز بدوري أبطال أوروبا 2023؟",
        answer: "مانشستر سيتي",
        options: ["مانشستر سيتي", "ريال مدريد", "بايرن ميونخ", "تشيلسي"]
      }
    ],
    hard: [
      {
        question: "ما هو الفريق الذي لم يهبط قط من الدرجة الأولى في إنجلترا؟",
        answer: "أرسنال",
        options: ["أرسنال", "مانشستر يونايتد", "ليفربول", "تشيلسي"]
      },
      {
        question: "من هو الهداف التاريخي لكأس العالم؟",
        answer: "ميروسلاف كلوزه",
        options: ["ميروسلاف كلوزه", "رونالدو", "جيرد مولر", "بيليه"]
      }
    ]
  },

  entertainment: {
    easy: [
      {
        question: "ما هو اسم ملكة بريطانيا الحالية؟",
        answer: "إليزابيث الثانية",
        options: ["إليزابيث الثانية", "فيكتوريا", "آن", "ماري"]
      },
      {
        question: "من هو بطل فيلم 'تايتنك'؟",
        answer: "ليوناردو دي كابريو",
        options: ["ليوناردو دي كابريو", "براد بيت", "جوني ديب", "توم كروز"]
      },
      {
        question: "ما هو أشهر موقع تواصل اجتماعي؟",
        answer: "فيسبوك",
        options: ["فيسبوك", "تويتر", "انستغرام", "تيك توك"]
      },
      {
        question: "من هي المغنية التي تلقب بـ 'ملكة البوب'؟",
        answer: "مادونا",
        options: ["مادونا", "بريتني سبيرز", "ليدى غاغا", "بيونسيه"]
      },
      {
        question: "ما هو اسم مسلسل التنين الشهير؟",
        answer: "صراع العروش",
        options: ["صراع العروش", "vikings", "the walking dead", "breaking bad"]
      }
    ],
    medium: [
      {
        question: "من هو مخرج فيلم 'العراب'؟",
        answer: "فرانسيس فورد كوبولا",
        options: ["فرانسيس فورد كوبولا", "مارتن سكورسيزي", "ستيفن سبيلبرغ", "ألفريد هيتشكوك"]
      },
      {
        question: "ما هو الفيلم الحاصل على أكبر عدد من جوائز الأوسكار؟",
        answer: "تايتنك",
        options: ["تايتنك", "سيد الخواتم", "بن هور", "العراب"]
      }
    ],
    hard: [
      {
        question: "ما هو أول فيلم رسوم متحركة طويل من إنتاج ديزني؟",
        answer: "سنو وايت والأقزام السبعة",
        options: ["سنو وايت والأقزام السبعة", "بينوكيو", "سندريلا", "بامبي"]
      },
      {
        question: "من هو المخرج الوحيد الذي فاز بثلاثة Oscars لأفضل مخرج؟",
        answer: "فرانك كابرا",
        options: ["فرانك كابرا", "جون فورد", "ويليام وايلر", "بيلي وايلدر"]
      }
    ]
  },

  scientific: {
    easy: [
      {
        question: "ما هو الكوكب الأقرب إلى الشمس؟",
        answer: "عطارد",
        options: ["عطارد", "الزهرة", "الأرض", "المريخ"]
      },
      {
        question: "كم عدد عظام جسم الإنسان؟",
        answer: "206",
        options: ["206", "200", "210", "196"]
      },
      {
        question: "ما هو الغاز الأكثر وفرة في الغلاف الجوي للأرض؟",
        answer: "النيتروجين",
        options: ["النيتروجين", "الأكسجين", "ثاني أكسيد الكربون", "الهيدروجين"]
      },
      {
        question: "ما هو أسرع حيوان بري؟",
        answer: "الفهد",
        options: ["الفهد", "الأسد", "النمر", "الغزال"]
      },
      {
        question: "ما هو المعدن السائل في درجة حرارة الغرفة؟",
        answer: "الزئبق",
        options: ["الزئبق", "الذهب", "الفضة", "النحاس"]
      }
    ],
    medium: [
      {
        question: "ما هو أصغر عظم في جسم الإنسان؟",
        answer: "عظم الركاب",
        options: ["عظم الركاب", "عظم السندان", "عظم المطرقة", "عظم الكعبرة"]
      },
      {
        question: "كم عدد الكروموسومات في الخلية البشرية؟",
        answer: "46",
        options: ["46", "23", "48", "42"]
      }
    ],
    hard: [
      {
        question: "ما هي النظرية التي وضعها أينشتاين لشرح الجاذبية؟",
        answer: "النظرية النسبية العامة",
        options: ["النظرية النسبية العامة", "النظرية النسبية الخاصة", "نظرية الكم", "نظرية الأوتار"]
      },
      {
        question: "ما هو أصل كلمة 'كيمياء'؟",
        answer: "مصري",
        options: ["مصري", "يوناني", "عربي", "فارسي"]
      }
    ]
  },

  mathematical: {
    easy: [
      {
        question: "ما هو ناتج 5 × 5؟",
        answer: "25",
        options: ["25", "20", "30", "15"]
      },
      {
        question: "ما هو العدد الأولي؟",
        answer: "العدد الذي يقبل القسمة على نفسه والواحد فقط",
        options: [
          "العدد الذي يقبل القسمة على نفسه والواحد فقط",
          "العدد الزوجي",
          "العدد الفردي",
          "العدد الذي يقبل القسمة على 2"
        ]
      },
      {
        question: "ما هو محيط الدائرة؟",
        answer: "2 × π × نصف القطر",
        options: [
          "2 × π × نصف القطر",
          "π × نصف القطر²",
          "4 × π × نصف القطر",
          "π × القطر"
        ]
      },
      {
        question: "ما هو ناتج 12 ÷ 4؟",
        answer: "3",
        options: ["3", "4", "2", "6"]
      },
      {
        question: "ما هو العدد التالي في المتتالية: 2, 4, 6, 8, ...؟",
        answer: "10",
        options: ["10", "9", "12", "14"]
      }
    ],
    medium: [
      {
        question: "ما هو قيمة π تقريباً؟",
        answer: "3.14",
        options: ["3.14", "2.71", "1.61", "4.13"]
      },
      {
        question: "ما هو قانون فيثاغورس؟",
        answer: "مربع الوتر = مربع الضلع الأول + مربع الضلع الثاني",
        options: [
          "مربع الوتر = مربع الضلع الأول + مربع الضلع الثاني",
          "مربع الضلع = مربع الوتر + مربع الضلع الآخر",
          "الوتر = الضلع الأول + الضلع الثاني",
          "مربع الوتر = الضلع الأول × الضلع الثاني"
        ]
      }
    ],
    hard: [
      {
        question: "ما هو ناتج تكامل x²؟",
        answer: "(x³/3) + C",
        options: ["(x³/3) + C", "x³ + C", "2x + C", "(x²/2) + C"]
      },
      {
        question: "ما هو العدد الذهبي؟",
        answer: "(1 + √5)/2",
        options: ["(1 + √5)/2", "(1 + √3)/2", "π", "e"]
      }
    ]
  }
};

router.get("/questions", async (req, res) => {
  const { category, difficulty } = req.query;
  
  if (!category || !difficulty) {
    return res.status(400).json({
      status: false,
      message: "Category and difficulty are required",
      example: "/api/game/questions?category=cultural&difficulty=easy",
      available_categories: ["cultural", "islamic", "football", "entertainment", "scientific", "mathematical"],
      available_difficulties: ["easy", "medium", "hard"]
    });
  }

  try {
    if (!questionsBank[category] || !questionsBank[category][difficulty]) {
      return res.status(404).json({
        status: false,
        message: "Category or difficulty not found"
      });
    }

    const questions = questionsBank[category][difficulty];
    const randomQuestion = questions[Math.floor(Math.random() * questions.length)];

    res.json({
      status: true,
      question: randomQuestion.question,
      options: randomQuestion.options,
      category: category,
      difficulty: difficulty
    });
    
  } catch (err) {
    res.status(500).json({
      status: false,
      message: "Server error",
      error: err.message
    });
  }
});

module.exports = {
  path: "/api/game",
  name: "Questions Bank API",
  type: "game",
  url: `${global.t}/api/game/questions?category=cultural&difficulty=easy`,
  logo: "",
  description: "بنك أسئلة ضخم يشمل الثقافة العامة، الإسلامية، كرة القدم، الترفيه، العلوم، والرياضيات بمستويات صعوبة مختلفة",
  router
};